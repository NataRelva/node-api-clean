generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Account {
  id                   String    @id @unique @default(uuid())
  name                 String
  email                String    @unique
  password             String
  cpfCnpj              String    @unique
  phone                String
  accessToken          String    @unique @default("")
  role                 String    @default("user")
  passwordResetToken   String?   @unique
  passwordResetExpires DateTime?
  createdAt            DateTime  @default(now())
  updatedAt            DateTime  @updatedAt
}

model Log {
  id        String   @id @unique @default(uuid())
  stack     String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Product {
  id                   String                 @id @unique @default(uuid())
  name                 String
  weight               Float
  obs                  String
  price                Float
  provider             String
  createdAt            DateTime               @default(now())
  updatedAt            DateTime               @updatedAt
  CartItem             CartItem[]
  ProductToSubCategory ProductToSubCategory[]
  category             Category[]             @relation("CategoryToProduct")
  mainCategory         MainCategory[]         @relation("MainCategoryToProduct")
  package              Package[]              @relation("PackageToProduct")
  unit                 Unit[]                 @relation("ProductToUnit")

  @@map("rmoura_product")
}

model Unit {
  id        String    @id @unique @default(uuid())
  name      String    @unique
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  product   Product[] @relation("ProductToUnit")

  @@map("rmoura_unit")
}

model Package {
  id        String    @id @unique @default(uuid())
  name      String    @unique
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  product   Product[] @relation("PackageToProduct")

  @@map("rmoura_package")
}

model Category {
  id        String    @id @unique @default(uuid())
  name      String    @unique
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  product   Product[] @relation("CategoryToProduct")

  @@map("rmoura_category")
}

model MainCategory {
  id      String    @id @unique @default(uuid())
  name    String    @unique
  product Product[] @relation("MainCategoryToProduct")
}

model SubCategory {
  id                   String                 @id @unique @default(uuid())
  name                 String                 @unique
  ProductToSubCategory ProductToSubCategory[]
}

model Cart {
  id        String     @id @unique @default(uuid())
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  item      CartItem[]
}

model CartItem {
  id        String   @id @unique @default(uuid())
  price     Float
  quantity  Int
  productId String
  cartId    String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  Cart      Cart?    @relation(fields: [cartId], references: [id])
  product   Product  @relation(fields: [productId], references: [id])
}

model ProductToSubCategory {
  A              String
  B              String
  SubCategory    SubCategory @relation(fields: [B], references: [id], onDelete: Cascade)
  rmoura_product Product     @relation(fields: [A], references: [id], onDelete: Cascade)

  @@unique([A, B], map: "_ProductToSubCategory_AB_unique")
  @@index([B], map: "_ProductToSubCategory_B_index")
  @@map("_ProductToSubCategory")
}
